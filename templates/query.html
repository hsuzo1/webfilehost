{% extends 'base.html' %}

{% block head %}
文档查询 -
{% endblock %}

{% block body %}
<div class="container">
    <!--提示信息-->
    <div class="alert alert-warning alert-dismissible fade show" id="msg" role="alert" style="display:none">
        <strong>提示：</strong><span id="msg_span"></span>
        <button type="button" class="btn-close" id="msg_btn" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
<!--模糊查询要素提交及清空、结果导出-->
    <form action="/qry" method="POST" id="qryForm">
        {% include 'basetag.html' %}
        <div class="row text-center">
            <div class="col-4">
                <a href="/clear">
                    <button class="btn btn-primary" type="button">清空查询</button>
                </a>
            </div>
            <div class="col-4">
                <button class="btn btn-primary" type="submit" id="btn_query">查询数据</button>
            </div>
            <div class="col-4">
                <a href="/export" role="button" class="btn btn-primary">导出数据</a>
            </div>
        </div>
    </form>
</div>
<br>

<!--显示查询结果表格-->
{% include 'resulttable.html' %}

{% endblock %}


<!--enctype="multipart/form-data"-->
<!-- ajax方法上传文件到服务器，并取得反馈信息。 -->
<script type="text/javascript">
    function ajaxForm(obj, id, type){
    event.preventDefault();
    var form= new FormData(document.getElementById(obj));
<!--    显示模态进度窗口-->
    $('#spinner').click();
<!--    异步上传文件-->
    $.ajax({
        url:"/upload/" +type+ "/" + id,
        type:"post",
        data:form,
        dataType: 'json',
        processData:false,
        contentType:false,
        success:function(data){
                $('#msg_span').text(data.msg);
                $('#msg').show();
                $('#btn_Close_Modal').click();
                $('#upload_' + type + id).attr("style", "display:none;");
                $('#view_' + type + id).attr("style", "display:block;");
        },
        error:function(e){
                $('#btn_Close_Modal').click();
                alert(data.msg);
        },
    });
}
</script>
<script src="{{url_for('static', filename='js/jquery.min.js')}}"></script>
